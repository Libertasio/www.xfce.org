<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>Drop Shadow Effect for GTK+-2.2.x/2.4.x Menus</title>
  <meta name="author" content="Olivier Fourdan">
  <meta name="description"
 content="A patch for gtk+-2.2.x/2.4.x that provides drop shadow for menus">
</head>
<body style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);"
 link="#000099" vlink="#990099" alink="#000099">
<h1>Drop Shadow Effect for GTK+-2.2.x/GTK+-2.4.x Menus</h1>
<small><span style="font-style: italic;">Last update: 2004-06-20 -
Olivier Fourdan &lt; fourdan at xfce dot org&gt;</span></small><br>
<h2>Introduction<br>
</h2>
The following patches are based on the work from Iain <a
 href="http://mail.gnome.org/archives/desktop-devel-list/2003-February/msg00641.html">published</a>
on the GNOME desktop devel list in February 2003.<br>
<br>
I took Iain's patch and tried to fix all the issues I found, while
improving the overall look of the drop shadow.<br>
<br>
It's not perfect (and I doubt it will ever be unless someone comes up
with true alpha blendering on X11), it's still a hack, but it works
fairly well (for me at least). I've tried this patch with plenty of
gtk2
based software, like xfce4, Eclipse 2.1, gnome 2.2, Ximian evolution
1.4, Abiword-2.0 and it worked all right so far.<br>
<br>
The patched library should be binary compatible with an unpatched
version. <br>
<br>
<div style="text-align: center;"><span
 style="text-decoration: underline; font-weight: bold;"><span
 style="color: rgb(204, 0, 0);">This comes with ABSOLUTELY NO WARRANTY
OF ANY KIND - USE IT AT YOUR OWN RISK.</span><br>
Make sure you
backup the original gtk+-2.x library before installing the patched
version</span><span style="font-weight: bold;">.</span><br>
</div>
<h2>Screenshot<br>
</h2>
Most people will wonder how it looks, some will even wonder what I'm
talking about. So here comes a screenshot.<br>
<br>
Notice the thin shadow under the menu :<br>
<br>
<div style="text-align: center;"><img src="gtkmenu-shadow.png"
 title="Screenshot" alt="" style="width: 574px; height: 219px;"><br>
</div>
<h2>Applying the patch<br>
</h2>
<span style="font-weight: bold; color: rgb(204, 0, 0);"></span>The most
recent version of the patch applies to gtk+-2.4. You should use this
one if you are running a recent Linux distribution that ships <span
 style="font-weight: bold;">gtk+-2.4</span> (such as <a
 href="http://fedora.redhat.com">fedora</a> Core 2).<br>
<ol>
  <li>Get the patch <a
 href="http://prdownloads.sourceforge.net/xfce/gtk+-2.4.0-menushadow.patch?download">here</a>
(15Kb) and
save it on your hard drive<br>
  </li>
  <li>Get gtk+-2.4.? sources from <a
 href="ftp://ftp.gtk.org/pub/gtk/v2.4/">here</a></li>
  <li>Untar it in some location of your hard drive</li>
  <li>Change directory to gtk+-2.4.?/ (change "?" to the correct
value)<br>
  </li>
  <li>Apply the patch with "cat <i>&lt;path_to_the_patch&gt;</i>/gtk+-2.4.0-menushadow.patch
| patch -p1"</li>
  <li>Compile and install the patched version of gtk+ (I use
"./configure --prefix=/usr --sysconfdir=/etc &amp;&amp; make &amp;&amp;
make install" myself, adjust to your taste)</li>
  <li>Run a gtk2 based application and enjoy :)</li>
</ol>
The older patch applies on a <span style="font-weight: bold;">gtk+-2.2</span>
source tree. This version should be used for those who run an older
version of Linux that ships with gtk+-2.2 (do not use this
patch on
a gtk+-2.0 source tree, that won't work and there is no plan to
backport
this patch to gtk+-2.0.x)<br>
<ol>
  <li>Get the patch <a
 href="http://prdownloads.sourceforge.net/xfce/gtk+-menushadow.patch?download">here</a>
(15Kb) and
save it on your hard drive<br>
  </li>
  <li>Get gtk+-2.2.? sources from <a
 href="ftp://ftp.gtk.org/pub/gtk/v2.2/">here</a></li>
  <li>Untar it in some location of your hard drive</li>
  <li>Change directory to gtk+-2.2.?/ (change "?" to the correct
value)<br>
  </li>
  <li>Apply the patch with "cat <i>&lt;path_to_the_patch&gt;</i>/gtk+-menushadow.patch
| patch -p1"</li>
  <li>Compile and install the patched version of gtk+ (I use
"./configure --prefix=/usr --sysconfdir=/etc &amp;&amp; make &amp;&amp;
make install" myself, adjust to your taste)</li>
  <li>Run a gtk2 based application and enjoy :)</li>
</ol>
<h2>Getting a pre-patched&nbsp;RPM<br>
</h2>
<ul>
  <li>A binary RPM archive for <span style="font-weight: bold;">gtk+-2.4.3</span>
patched is available <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-2.4.3-1_shadow.i386.rpm?download">here</a>
(13Mb), with devel RPM package <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-devel-2.4.3-1_shadow.i386.rpm?download">here</a>
(1.9Mb) and source RPM <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-2.4.3-1_shadow.src.rpm?download">here</a>
(8.2Mb).</li>
  <li>A binary RPM archive for <span style="font-weight: bold;">gtk+-2.2.4</span>
for <b>Red Hat 9</b> is available <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-2.2.4-1rh9.i386.rpm?download">here</a>
(3Mb), devel RPM package <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-devel-2.2.4-1rh9.i386.rpm?download">here</a>
(1.2Mb) and source RPM <a
 href="http://prdownloads.sourceforge.net/xfce/gtk2-2.2.4-1.src.rpm?download">here</a>)
(6.3Mb)</li>
</ul>
Note this version also includes patches from Red Hat and Ximian Desktop
2.<br>
<h2>Getting a pre-patched&nbsp;tarball<br>
</h2>
<ul>
  <li>A <span style="font-weight: bold;">gtk+-2.4.3</span> prepatched
source tree is available <a
 href="http://prdownloads.sourceforge.net/xfce/gtk+-2.4.3-menushadow.1.tar.bz2?download">here</a>
(8.5Mb)</li>
  <li>Alternatively, you can grab a patched source tree of <span
 style="font-weight: bold;">gtk+-2.2.4</span> <a
 href="http://prdownloads.sourceforge.net/xfce/gtk+-2.2.4-menushadow.1.tar.bz2?download">here</a>
(6.9Mb)</li>
</ul>
This version also includes patches from Red Hat and Ximian Desktop 2.<br>
<h2>Configuration</h2>
There are a couple of parameters that can be adjusted using the gtkrc
file (either from a theme or from $HOME/.gtkrc-2.0)<br>
<ul>
  <li>gtk-menu-drop-shadow : When set to 0, menu shadow will be turned
off. Any non-zero value enables menu shadow (default value: 1)</li>
  <li>gtk-menu-shadow-delay : The delay before the shadow appears. The
shadow is delayed to give some time to the underlying application to
refresh its window. You can increase or decrease this value to adjust
the shadow to your system (default: 100)<br>
  </li>
</ul>
<h2>Feedback<br>
</h2>
Well, I make this available, but I don't have much time to support it.
Use it at your own risk! However, if you really want to send some
feedback, you can mail me here:<br>
<br>
Olivier Fourdan &lt;fourdan at xfce dot org&gt;<br>
<h2>Changes</h2>
<table cellpadding="2" cellspacing="2" border="1"
 style="text-align: left; width: 100%;">
  <tbody>
    <tr>
      <td style="vertical-align: top;">2003-05-20<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Initial Release</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-05-21<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Make shadow 5 pixels wide (instead of 4)</li>
        <li>Fix a display bug and a memory leak when the menu is
located on a screen edge</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-05-23<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Bug fix</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-06-05<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Move files to sf.net</li>
        <li>Make Red Hat 9 rpms available</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-06-21<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Fix a bug in multiscreen mode (not Xinerama) that caused
GNOME panel to crash</li>
        <li>Update to gtk version 2.2.2</li>
        <li>Add some patches from Ximian Desktop 2 to prebuilt rpms and
tarball</li>
      </ul>
Gert-Jan Brink<br>
      <ul>
        <li>Smoother shadows and corners</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-07-06<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Fix src rpm so it builds on non Red Hat systems (ie w/out
patched fontconfig)</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2003-09-09<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Update to gtk version 2.2.4</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2004-03-10<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Port to gtk version 2.3.6</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2004-03-20<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Port to gtk version 2.4.0</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2004-05-02<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Prepare gtk+-2.4.1 pre-patched version</li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">2004-06-20<br>
      </td>
      <td style="vertical-align: top;">Olivier Fourdan<br>
      <ul>
        <li>Prepare gtk+-2.4.3 pre-patched version</li>
      </ul>
      </td>
    </tr>
  </tbody>
</table>
<br>
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=19869&amp;type=5" width="105" height="31" border="0" alt="SourceForge.net Logo" /></a>
<br>
<br>
</body>
</html>
